<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DivulgaHub - Detalhes do Artista</title>
    <link rel="stylesheet" href="detalhes-style.css"> 
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1>DivulgaHub</h1>
        <button class="back-button" onclick="history.back()">Voltar</button>

        <div id="artist-details-content">
            <div class="artist-header">
                <img id="artist-avatar" src="" alt="Foto do Artista" class="artist-avatar">
                <h2 id="artist-name" class="artist-name"></h2>
                <p id="artist-genre-display" class="artist-genre"></p>
            </div>

            <p id="artist-bio" class="artist-bio"></p>

            <h2 class="section-title">Onde Encontrar Artista</h2>
            <div id="social-media-links" class="social-media">
                </div>

            <h2 class="section-title">Trabalhos Recentes</h2>
            <div id="recent-works-container" class="recent-works">
                </div>
            <p id="no-recent-works-message" style="display: none;">Nenhum trabalho recente cadastrado para este artista.</p>
        </div>
        
        <p id="artist-not-found">Artista não encontrado. Verifique o ID na URL.</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos HTML onde os detalhes do artista serão exibidos
            const artistAvatar = document.getElementById('artist-avatar');
            const artistName = document.getElementById('artist-name');
            const artistGenreDisplay = document.getElementById('artist-genre-display');
            const artistBio = document.getElementById('artist-bio');
            const socialMediaLinksDiv = document.getElementById('social-media-links');
            const recentWorksContainer = document.getElementById('recent-works-container'); 
            const artistDetailsContent = document.getElementById('artist-details-content');
            const artistNotFoundMessage = document.getElementById('artist-not-found');
            const noRecentWorksMessage = document.getElementById('no-recent-works-message');

            // 1. Obter o ID do artista da URL (ex: detalhes-artista.html?id=123)
            const urlParams = new URLSearchParams(window.location.search);
            const artistId = parseInt(urlParams.get('id'));

            // Verifica se o ID é um número válido. Se não for, esconde o conteúdo e exibe a mensagem de erro.
            if (isNaN(artistId)) {
                artistDetailsContent.style.display = 'none';
                artistNotFoundMessage.style.display = 'block';
                return; // Encerra a execução do script
            }

            // 2. Carregar todos os artistas do localStorage
            const artistas = JSON.parse(localStorage.getItem('artistas')) || [];

            // 3. Encontrar o artista específico pelo ID
            const artista = artistas.find(a => a.id === artistId);

            if (artista) {
                // 4. Preencher os elementos HTML com os dados do artista encontrado
                artistAvatar.src = artista.foto || 'https://via.placeholder.com/150?text=Sem+Foto'; // Usa a foto do artista ou uma imagem placeholder
                artistName.textContent = artista.nomeArtistico;
                artistGenreDisplay.textContent = `|${artista.genero}|`; // Usando 'genero' para gênero musical
                artistBio.textContent = artista.descricao;

                // 5. Preencher os links de redes sociais dinamicamente
                socialMediaLinksDiv.innerHTML = ''; // Limpa qualquer link estático existente

                // Cria e adiciona links apenas se a URL existir no objeto do artista
                if (artista.spotify) {
                    const link = document.createElement('a');
                    link.href = artista.spotify;
                    link.target = '_blank';
                    link.textContent = 'Spotify';
                    socialMediaLinksDiv.appendChild(link);
                }
                if (artista.instagram) {
                    const link = document.createElement('a');
                    link.href = artista.instagram;
                    link.target = '_blank';
                    link.textContent = 'Instagram';
                    socialMediaLinksDiv.appendChild(link);
                }
                if (artista.youtube) {
                    const link = document.createElement('a');
                    link.href = artista.youtube;
                    link.target = '_blank';
                    link.textContent = 'YouTube';
                    socialMediaLinksDiv.appendChild(link);
                }
                if (artista.facebook) {
                    const link = document.createElement('a');
                    link.href = artista.facebook;
                    link.target = '_blank';
                    link.textContent = 'Facebook';
                    socialMediaLinksDiv.appendChild(link);
                }

                // 6. Preencher os Trabalhos Recentes dinamicamente
                recentWorksContainer.innerHTML = ''; // Limpa qualquer conteúdo estático ou anterior

                if (artista.trabalhosRecentes && artista.trabalhosRecentes.length > 0) {
                    artista.trabalhosRecentes.forEach(work => {
                        const workItem = document.createElement('div');
                        workItem.classList.add('work-item');

                        workItem.innerHTML = `
                            <img src="${work.capa || 'https://via.placeholder.com/200?text=Sem+Capa'}" alt="Capa do ${work.titulo}">
                            <div class="work-item-info">
                                <h3>${work.titulo}</h3>
                                <p>Lançamento: ${work.lancamento}</p>
                                <a href="${work.linkYoutube}" target="_blank">Ouvir no Youtube</a>
                            </div>
                        `;
                        recentWorksContainer.appendChild(workItem);
                    });
                    noRecentWorksMessage.style.display = 'none'; // Esconde a mensagem se houver trabalhos
                } else {
                    noRecentWorksMessage.style.display = 'block'; // Mostra a mensagem se não houver trabalhos
                }


                // Exibe o conteúdo do artista e esconde a mensagem de não encontrado
                artistDetailsContent.style.display = 'block';
                artistNotFoundMessage.style.display = 'none';

            } else {
                // Se o artista não for encontrado (ID válido, mas não existe na lista)
                artistDetailsContent.style.display = 'none';
                artistNotFoundMessage.style.display = 'block';
            }
        });
    </script>
</body>
</html>